<Page x:Class="AlexAssistant.CommandInputPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:local="clr-namespace:AlexAssistant.Models"
      mc:Ignorable="d"
      d:DesignHeight="700" d:DesignWidth="600"
      Title="Add Custom Commands"
      Background="#FF2C2C2C"
      Foreground="#FFDCDCDC"
      FontFamily="Segoe UI Variable Text"
      >

    <Page.Resources>
        <SolidColorBrush x:Key="AppBackgroundBrush" Color="#FF2C2C2C"/>
        <SolidColorBrush x:Key="InputBackgroundBrush" Color="#FF2B2B2B"/>
        <SolidColorBrush x:Key="InputBorderBrush" Color="#FF404040"/>
        <SolidColorBrush x:Key="InputFocusBorderBrush" Color="#FF007ACC"/>
        <SolidColorBrush x:Key="TextPrimaryBrush" Color="#FFDCDCDC"/>
        <SolidColorBrush x:Key="TextSecondaryBrush" Color="#FF888888"/>
        <SolidColorBrush x:Key="AccentBrush" Color="#FF007ACC"/>
        <SolidColorBrush x:Key="AccentHoverBrush" Color="#FF009AFF"/>
        <SolidColorBrush x:Key="AccentPressedBrush" Color="#FF005A9E"/>
        <SolidColorBrush x:Key="DestructiveAccentBrush" Color="#FFE81123"/>
        <SolidColorBrush x:Key="DestructiveAccentHoverBrush" Color="#FFFF4C5B"/>
        <SolidColorBrush x:Key="ListItemBackgroundBrush" Color="#FF333333"/>
        <SolidColorBrush x:Key="ListItemHoverBackgroundBrush" Color="#FF3D3D3D"/>

        <Geometry x:Key="TrashIconGeometry">M10,4 C10.5522847,4 11,4.44771525 11,5 L11,6 L17,6 C17.5522847,6 18,6.44771525 18,7 C18,7.55228475 17.5522847,8 17,8 L7,8 C6.44771525,8 6,7.55228475 6,7 C6,6.44771525 6.44771525,6 7,6 L13,6 L13,5 C13,4.44771525 13.4477153,4 14,4 L10,4 Z M6,9 L7.70807435,20.1991296 C7.85861696,21.1905684 8.70588235,22 9.71428571,22 L14.2857143,22 C15.2941176,22 16.141383,21.1905684 16.2919256,20.1991296 L18,9 L6,9 Z</Geometry>

        <Style TargetType="TextBlock" x:Key="SectionHeaderStyle">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
            <Setter Property="Margin" Value="0,0,0,12"/>
        </Style>

        <Style TargetType="TextBox" x:Key="ModernTextBoxStyle">
            <Setter Property="Background" Value="{StaticResource InputBackgroundBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource InputBorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="Height" Value="38"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="CaretBrush" Value="{StaticResource TextPrimaryBrush}"/>
            <Setter Property="SelectionBrush" Value="{StaticResource AccentBrush}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4" SnapsToDevicePixels="True">
                            <ScrollViewer x:Name="PART_ContentHost" Focusable="false" HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Hidden"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsKeyboardFocused" Value="True">
                                <Setter TargetName="border" Property="BorderBrush" Value="{StaticResource InputFocusBorderBrush}"/>
                                <Setter TargetName="border" Property="BorderThickness" Value="1.5"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="TextBlock" x:Key="PlaceholderTextBlockStyle">
            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="14,8,8,8"/>
            <Setter Property="IsHitTestVisible" Value="False"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Visibility" Value="Visible"/>
        </Style>

        <Style TargetType="Button" x:Key="PrimaryButtonStyle">
            <Setter Property="Background" Value="{StaticResource AccentBrush}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="20,0"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Height" Value="38"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="4" SnapsToDevicePixels="True">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{StaticResource AccentHoverBrush}"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{StaticResource AccentPressedBrush}"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="border" Property="Background" Value="#FF555555"/>
                                <Setter Property="Foreground" Value="#FFAAAAAA"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="Button" x:Key="RemoveIconButtonStyle">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="5"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Width" Value="30"/>
            <Setter Property="Height" Value="30"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="15" SnapsToDevicePixels="True">
                            <Path x:Name="iconPath" Data="{StaticResource TrashIconGeometry}"
                                   Fill="{TemplateBinding Foreground}"
                                   Stretch="Uniform" Width="14" Height="14"
                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="iconPath" Property="Fill" Value="{StaticResource DestructiveAccentBrush}"/>
                                <Setter TargetName="border" Property="Background" Value="#20E81123"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="iconPath" Property="Fill" Value="{StaticResource DestructiveAccentHoverBrush}"/>
                                <Setter TargetName="border" Property="Background" Value="#40E81123"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="{x:Type RadioButton}">
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Margin" Value="0,0,25,0"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type RadioButton}">
                        <Grid Background="Transparent">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Border x:Name="radioButtonBorder" Grid.Column="0"
                                    Width="18" Height="18"
                                    CornerRadius="9"
                                    BorderThickness="1.5"
                                    BorderBrush="{StaticResource TextSecondaryBrush}"
                                    Background="Transparent"
                                    VerticalAlignment="Center">
                                <Ellipse x:Name="checkedEllipse" Fill="{StaticResource AccentBrush}"
                                         Width="10" Height="10" HorizontalAlignment="Center" VerticalAlignment="Center"
                                         Visibility="Collapsed"/>
                            </Border>
                            <ContentPresenter Grid.Column="1"
                                              Margin="8,0,0,0"
                                              VerticalAlignment="Center"
                                              RecognizesAccessKey="True"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="radioButtonBorder" Property="BorderBrush" Value="{StaticResource AccentBrush}"/>
                                <Setter TargetName="checkedEllipse" Property="Visibility" Value="Visible"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="radioButtonBorder" Property="BorderBrush" Value="{StaticResource AccentHoverBrush}"/>
                                <Setter TargetName="checkedEllipse" Property="Fill" Value="{StaticResource AccentHoverBrush}"/>
                            </Trigger>
                            <Trigger Property="IsKeyboardFocused" Value="True">
                                <Setter TargetName="radioButtonBorder" Property="BorderBrush" Value="{StaticResource InputFocusBorderBrush}"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style TargetType="ScrollBar">
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="OverridesDefaultStyle" Value="True"/>
            <Setter Property="Width" Value="8"/>
           
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollBar">
                        <Grid Background="Transparent">
                            <Track Name="PART_Track"
                        IsDirectionReversed="true"
                        Focusable="false">
                                <Track.Thumb>
                                    <Thumb Background="#393939" Height="40" Margin="0">
                                        <Thumb.Template>
                                            <ControlTemplate TargetType="Thumb">
                                                <Border Background="{TemplateBinding Background}"
                                             BorderBrush="#393939"
                                             BorderThickness="0"
                                             CornerRadius="4"/>
                                            </ControlTemplate>
                                        </Thumb.Template>
                                    </Thumb>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Page.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
        <Grid Margin="40">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="40"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <StackPanel Grid.Row="0" VerticalAlignment="Top" HorizontalAlignment="Stretch" MaxWidth="550">

                <TextBlock Text="Create a New Command" Style="{StaticResource SectionHeaderStyle}" FontSize="18" Margin="0,0,0,20"/>

                <TextBlock Text="1. Command Phrase" FontWeight="Normal" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,5"/>
                <Grid Margin="0,0,0,20">
                    <TextBox x:Name="PhraseInput" Style="{StaticResource ModernTextBoxStyle}" TextChanged="Input_TextChanged"/>
                    <TextBlock x:Name="PhrasePlaceholder" Text="What phrase will trigger the action?" Style="{StaticResource PlaceholderTextBlockStyle}"/>
                </Grid>

                <TextBlock Text="2. Action Type" FontWeight="Normal" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,8"/>
                <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                    <RadioButton x:Name="LinkRadioButton" Content="Open Link (URL)" GroupName="ActionType" IsChecked="True" Checked="ActionType_Changed"/>
                    <RadioButton x:Name="PathRadioButton" Content="Open File / Folder" GroupName="ActionType" Checked="ActionType_Changed"/>
                </StackPanel>

                <TextBlock Text="3. Action Target" FontWeight="Normal" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,5"/>
                <Grid Margin="0,0,0,25">
                    <TextBox x:Name="ActionTargetInput" Style="{StaticResource ModernTextBoxStyle}" TextChanged="Input_TextChanged"/>
                    <TextBlock x:Name="ActionTargetPlaceholder" Text="Enter the URL..." Style="{StaticResource PlaceholderTextBlockStyle}"/>
                </Grid>

                <Button x:Name="AddCommandButton"
                        Content="Add Command"
                        Style="{StaticResource PrimaryButtonStyle}"
                        HorizontalAlignment="Right"
                        Click="AddCommand_Click"/>
            </StackPanel>

            <Grid Grid.Row="2">
                <TextBlock Text="Saved Commands" Style="{StaticResource SectionHeaderStyle}" VerticalAlignment="Top"/>

                <ListView x:Name="CommandsListView"
                          Background="Transparent"
                          BorderThickness="0"
                          ItemsSource="{Binding SavedCommands}"
                          ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                          ScrollViewer.VerticalScrollBarVisibility="Disabled"
                          SelectionMode="Single"
                          HorizontalContentAlignment="Stretch"
                          Margin="0,40,0,0">

                    <ListView.ItemContainerStyle>
                        <Style TargetType="ListViewItem">
                            <Setter Property="Focusable" Value="False"/>
                            <Setter Property="Padding" Value="0"/>
                            <Setter Property="Margin" Value="0,0,0,10"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="ListViewItem">
                                        <Border x:Name="ItemBorder"
                                                Background="{StaticResource ListItemBackgroundBrush}"
                                                Padding="20,15"
                                                CornerRadius="6">
                                            <ContentPresenter/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="ItemBorder" Property="Background" Value="{StaticResource ListItemHoverBackgroundBrush}"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </ListView.ItemContainerStyle>

                    <ListView.ItemTemplate>
                        <DataTemplate DataType="{x:Type local:CommandItem}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                    <TextBlock Text="{Binding Phrase}"
                                                FontWeight="SemiBold"
                                                FontSize="15"
                                                Foreground="{StaticResource TextPrimaryBrush}"
                                                TextTrimming="CharacterEllipsis"
                                                Margin="0,0,0,5"/>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="{Binding ActionType, StringFormat={}{0}}"
                                                    FontWeight="Normal" FontSize="12"
                                                    Foreground="{StaticResource AccentBrush}"
                                                    Margin="0,0,8,0"/>
                                        <TextBlock Text="{Binding ActionTarget}"
                                                    FontWeight="Normal" FontSize="12"
                                                    Foreground="{StaticResource TextSecondaryBrush}"
                                                    TextTrimming="CharacterEllipsis"/>
                                    </StackPanel>
                                </StackPanel>

                                <Button Grid.Column="1"
                                        Style="{StaticResource RemoveIconButtonStyle}"
                                        Click="RemoveCommand_Click"
                                        CommandParameter="{Binding}"
                                        ToolTip="Remove Command"/>
                            </Grid>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </Grid>
        </Grid>
    </ScrollViewer>
</Page>